rules_version = '2';
service cloud.firestore {
  match /databases/{database}/documents {
    // Collection des bons d'intervention
    match /bons/{bonId} {
      // Lecture : autorisée pour tous (nécessaire pour l'affichage)
      allow read: if true;
      
      // Écriture : autorisée pour tous (temporaire)
      // Pour l'instant, on permet l'écriture car l'app n'utilise pas Firebase Auth
      // TODO: Implémenter Firebase Authentication pour sécuriser l'écriture
      allow create: if true; // ⚠️ TEMPORAIRE - À sécuriser avec auth
      allow update: if true; // ⚠️ TEMPORAIRE - À sécuriser avec auth
      allow delete: if true; // ⚠️ TEMPORAIRE - À sécuriser avec auth
    }
    
    // Collection des clients
    match /clients/{clientId} {
      // Lecture : autorisée pour tous (nécessaire pour la recherche)
      allow read: if true;
      
      // Écriture : autorisée pour tous (temporaire)
      // TODO: Implémenter Firebase Authentication pour sécuriser l'écriture
      allow create: if true; // ⚠️ TEMPORAIRE - À sécuriser avec auth
      allow update: if true; // ⚠️ TEMPORAIRE - À sécuriser avec auth
      allow delete: if true; // ⚠️ TEMPORAIRE - À sécuriser avec auth
    }
    
    // Paramètres par société (techniciens, codes d'accès, etc.)
    match /societes/{societeId}/parametres/{docId} {
      allow read, write: if true; // ⚠️ TEMPORAIRE - nécessaire pour gestion des accès techniciens
    }
    
    // Clients par société (recherche et formulaire technicien / admin)
    match /societes/{societeId}/clients/{clientId} {
      allow read, write: if true; // ⚠️ TEMPORAIRE - nécessaire pour la base clients
    }
    
    // Bons d'intervention par société
    match /societes/{societeId}/bons/{bonId} {
      allow read, write: if true; // ⚠️ TEMPORAIRE
    }
    
    // Compteurs par société (numérotation des bons)
    match /societes/{societeId}/compteurs/{docId} {
      allow read, write: if true; // ⚠️ TEMPORAIRE
    }
    
    // Bloquer l'accès à toutes les autres collections
    match /{document=**} {
      allow read, write: if false;
    }
  }
}

